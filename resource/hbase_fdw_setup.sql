-- =================================================== --
-- Ensure Multicorn is installed
-- CREATE EXTENSION IF NOT EXISTS multicorn;

-- HBase Server
DROP SERVER IF EXISTS hserver CASCADE;
CREATE SERVER hserver FOREIGN DATA WRAPPER multicorn
OPTIONS ( WRAPPER 'hbase_fdw.HappyBaseFdw');

-- Create HBase Test Table
DROP FOREIGN TABLE IF EXISTS hbtest;
CREATE FOREIGN TABLE IF NOT EXISTS hbtest (
  rowkey  TEXT,
  active  TEXT OPTIONS (qualifier 'stat:1_day_active_count'),
  install TEXT OPTIONS (qualifier 'stat:1_day_install_count'),
  launch  TEXT OPTIONS (qualifier 'stat:stat:1_day_launch_count')
) SERVER hserver OPTIONS (host '10.101.171.99', TABLE 'appuserstat', DEBUG 'True'
);

-- 9c9e_2016-02-02_56444370e7e12af0561e221c
-- d58c_2015-12-03_548935a4fd98c5d3510008bc
-- d58c_2015-12-03_548935a4fd98c5d3510008bc
-- d58c_2015-12-03_548935a4fd98c5d3510008bc
-- d58c_2015-12-03_548935a4fd98c5d3510008bc
-- b50d_2015-12-03_5506905ffd98c5ae1b0000de
-- b50d_2015-12-03_5506905ffd98c5ae1b0000de
-- b50d_2015-12-03_5506905ffd98c5ae1b0000de
-- b50d_2015-12-03_5506905ffd98c5ae1b0000de
-- e18d_2015-12-03_559e9b1067e58e2cdd002509
-- e18d_2015-12-03_559e9b1067e58e2cdd002509
-- e18d_2015-12-03_559e9b1067e58e2cdd002509
-- e18d_2015-12-03_559e9b1067e58e2cdd002509
-- 8545_2015-12-03_563b1f8f67e58e55580014d1
-- 8545_2015-12-03_563b1f8f67e58e55580014d1
-- 8545_2015-12-03_563b1f8f67e58e55580014d1
-- 8545_2015-12-03_563b1f8f67e58e55580014d1
-- 1516_2015-12-03_56430770cc3e5975ca000012
-- 1516_2015-12-03_56430770cc3e5975ca000012
-- 1516_2015-12-03_56430770cc3e5975ca000012
-- 1516_2015-12-03_56430770cc3e5975ca000012
--
-- SELECT *
-- FROM hbtest
-- WHERE rowkey = '9c9e_2016-02-02_56444370e7e12af0561e221c';
--
-- SELECT *
-- FROM hbtest
-- WHERE rowkey IN ('9c9e_2016-02-02_56444370e7e12af0561e221c',
--                  '8545_2015-12-03_563b1f8f67e58e55580014d1');
-- --
SELECT *
FROM hbtest
WHERE rowkey
BETWEEN '9c90' AND
'9c9f';

--       AND app_id = '56444370e7e12af0561e221c'
--       AND date IN ('2016-02-02', '2016-02-03');

-- 9c9e_2016-02-02_56444370e7e12af0561e221c